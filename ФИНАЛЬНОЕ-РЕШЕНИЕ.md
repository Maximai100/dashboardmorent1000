# ‚úÖ –§–ò–ù–ê–õ–¨–ù–û–ï –†–ï–®–ï–ù–ò–ï - –§–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–æ–≤ —Ä–∞–±–æ—Ç–∞—é—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é!

## –ü—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –§–∞–π–ª—ã –∑–∞–º–µ–Ω—è–ª–∏ –¥—Ä—É–≥ –¥—Ä—É–≥–∞ ‚ùå
**–ü—Ä–∏—á–∏–Ω–∞:** Directus –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –º–∞—Å—Å–∏–≤–∞ attachments —É–¥–∞–ª—è–ª –≤—Å–µ —Å—Ç–∞—Ä—ã–µ –∏ —Å–æ–∑–¥–∞–≤–∞–ª –Ω–æ–≤—ã–µ.

**–†–µ—à–µ–Ω–∏–µ:** ‚úÖ
- –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ñ–∞–π–ª—ã: –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º `{ id: X }`
- –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã: –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ë–ï–ó `id`
- –£–¥–∞–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã: –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º `{ id: X, _delete: true }`

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –§–∞–π–ª—ã –Ω–µ –∑–∞–≥—Ä—É–∂–∞–ª–∏—Å—å –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ ‚ùå
**–ü—Ä–∏—á–∏–Ω–∞:** –ó–∞–ø—Ä–æ—Å `fields=*,attachments.*` –Ω–µ —Ä–∞–±–æ—Ç–∞–ª –¥–ª—è M2M —Å–≤—è–∑–µ–π –≤ Directus.

**–†–µ—à–µ–Ω–∏–µ:** ‚úÖ
–Ø–≤–Ω–æ —É–∫–∞–∑—ã–≤–∞–µ–º –≤—Å–µ –ø–æ–ª—è attachments:
```typescript
fields: 'id,name,...,attachments.id,attachments.directus_files_id,attachments.url,attachments.title'
```

### –ü—Ä–æ–±–ª–µ–º–∞ 3: directus_files_id –ø—Ä–∏—Ö–æ–¥–∏–ª –∫–∞–∫ —Å—Ç—Ä–æ–∫–∞ ‚ùå
**–ü—Ä–∏—á–∏–Ω–∞:** Directus –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–æ–ª—å–∫–æ ID —Ñ–∞–π–ª–∞, –∞ –Ω–µ –ø–æ–ª–Ω—ã–π –æ–±—ä–µ–∫—Ç.

**–†–µ—à–µ–Ω–∏–µ:** ‚úÖ
–ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤ –¥–µ–ª–∞–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ `/files/{id}` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–∞–π–ª–∞.

## –ò—Ç–æ–≥–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### 1. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç —Ñ–∞–π–ª
    ‚Üì
uploadFile() ‚Üí Directus Files
    ‚Üì
–°–æ–∑–¥–∞–µ—Ç—Å—è attachment —Å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º ID
    ‚Üì
–§–∞–π–ª –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ
```

### 2. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
```
handleSaveChanges()
    ‚Üì
–§–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è payload:
  - –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ: { id: X }
  - –ù–æ–≤—ã–µ: { projects_id, directus_files_id, title }
  - –£–¥–∞–ª–µ–Ω–Ω—ã–µ: { id: X, _delete: true }
    ‚Üì
updateProject() ‚Üí Directus API
    ‚Üì
Directus –æ–±–Ω–æ–≤–ª—è–µ—Ç junction table
```

### 3. –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏
```
getProjects()
    ‚Üì
–ó–∞–ø—Ä–æ—Å —Å —è–≤–Ω—ã–º–∏ –ø–æ–ª—è–º–∏ attachments
    ‚Üì
Directus –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–æ–µ–∫—Ç—ã —Å attachments (directus_files_id –∫–∞–∫ —Å—Ç—Ä–æ–∫–∞)
    ‚Üì
–î–ª—è –∫–∞–∂–¥–æ–≥–æ attachment –∑–∞–≥—Ä—É–∂–∞–µ–º –ø–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª–∞
    ‚Üì
fetch(`/files/${id}`) ‚Üí –ø–æ–ª–Ω—ã–π –æ–±—ä–µ–∫—Ç —Ñ–∞–π–ª–∞
    ‚Üì
–§–∞–π–ª—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ
```

## –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### 1. components/manager/ProjectDetailModal.tsx
- **handleSaveChanges**: –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è payload –¥–ª—è M2M —Å–≤—è–∑–µ–π
- **handleFileSelect**: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ —Ñ–∞–π–ª–∞
- **–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–∞–∫ —Å—Ç—Ä–æ–∫–∏, —Ç–∞–∫ –∏ –æ–±—ä–µ–∫—Ç–∞ –¥–ª—è directus_files_id
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ü–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

### 2. services/directus.ts
- **getProjects**: –Ø–≤–Ω–æ–µ —É–∫–∞–∑–∞–Ω–∏–µ –ø–æ–ª–µ–π attachments + –∑–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- **getProjectAttachments**: –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- **updateProject**: –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ü–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏ –∑–∞–≥—Ä—É–∑–∫–∏

### 3. hooks/useProjectData.ts
- **updateProject**: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- **–ü—Ä–æ–≤–µ—Ä–∫–∞**: –ó–∞–≥—Ä—É–∑–∫–∞ —Å–≤–µ–∂–∏—Ö attachments –µ—Å–ª–∏ –Ω—É–∂–Ω–æ

### 4. types/manager.ts
- **ProjectAttachment**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ directus_files_id –∫–∞–∫ —Å—Ç—Ä–æ–∫–∏ –∏–ª–∏ –æ–±—ä–µ–∫—Ç–∞

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

### –¢–µ—Å—Ç 1: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–æ–µ–∫—Ç
2. –î–æ–±–∞–≤—å—Ç–µ —Ñ–∞–π–ª ‚Üí –¥–æ–ª–∂–µ–Ω –ø–æ—è–≤–∏—Ç—å—Å—è
3. –î–æ–±–∞–≤—å—Ç–µ –µ—â–µ —Ñ–∞–π–ª ‚Üí –æ–±–∞ –¥–æ–ª–∂–Ω—ã –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è
4. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ ‚Üí –æ–±–∞ —Ñ–∞–π–ª–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã

### –¢–µ—Å—Ç 2: –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞
1. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É (F5)
2. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–æ–µ–∫—Ç
3. –û–±–∞ —Ñ–∞–π–ª–∞ –¥–æ–ª–∂–Ω—ã –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è

### –¢–µ—Å—Ç 3: –£–¥–∞–ª–µ–Ω–∏–µ
1. –£–¥–∞–ª–∏—Ç–µ –æ–¥–∏–Ω —Ñ–∞–π–ª
2. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ
3. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ
4. –î–æ–ª–∂–µ–Ω –æ—Å—Ç–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ñ–∞–π–ª

## –õ–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏

### –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã:
```
üìÇ –ó–∞–≥—Ä—É–∂–µ–Ω–æ –ø—Ä–æ–µ–∫—Ç–æ–≤: 2
  üìã –ü—Ä–æ–µ–∫—Ç "–ù–∞–∑–≤–∞–Ω–∏–µ": attachments = Array(2)
üìé –ü—Ä–æ–µ–∫—Ç "–ù–∞–∑–≤–∞–Ω–∏–µ": 2 attachments
üîÑ –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞: 6404e30d-...
‚úÖ –§–∞–π–ª –∑–∞–≥—Ä—É–∂–µ–Ω: –Ω–∞–∑–≤–∞–Ω–∏–µ.pdf
üîÑ –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞: 868e7058-...
‚úÖ –§–∞–π–ª –∑–∞–≥—Ä—É–∂–µ–Ω: –Ω–∞–∑–≤–∞–Ω–∏–µ2.pdf
```

### –ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞:
```
üñºÔ∏è –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ attachments –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞ "–ù–∞–∑–≤–∞–Ω–∏–µ": {
  total: 2,
  valid: 2,
  attachments: [
    { id: 42, hasFile: true, fileType: "object", ... },
    { id: 43, hasFile: true, fileType: "object", ... }
  ]
}
```

### –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞:
```
üìé –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–π attachment: { projects_id: 20, directus_files_id: "...", title: "..." }
üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞: { projectId: 20, attachmentsCount: 2, ... }
üì§ –û—Ç–ø—Ä–∞–≤–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞: { id: 20, attachments: [...] }
üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞: { projectId: 20, ... }
üì• –ü–æ–ª—É—á–µ–Ω –æ—Ç–≤–µ—Ç –æ—Ç Directus: { attachmentsCount: 2, ... }
‚úÖ –ü—Ä–æ–µ–∫—Ç –æ–±–Ω–æ–≤–ª–µ–Ω: { id: 20, attachmentsCount: 2 }
```

## –°—Ç–∞—Ç—É—Å

‚úÖ –§–∞–π–ª—ã –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ  
‚úÖ –§–∞–π–ª—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ Directus  
‚úÖ –§–∞–π–ª—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏  
‚úÖ –§–∞–π–ª—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ  
‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç  
‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫  

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ñ–∞–π–ª—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å/—É–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª—ã
4. –í—Å–µ –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å!

## –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **–ò–°–ü–†–ê–í–õ–ï–ù–û-–ó–ê–ì–†–£–ó–ö–ê.txt** - –∫—Ä–∞—Ç–∫–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
- **–ò–°–ü–†–ê–í–õ–ï–ù–û-–ó–ê–ú–ï–ù–ê-–§–ê–ô–õ–û–í.md** - —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –∑–∞–º–µ–Ω—ã
- **–ü–û–õ–ù–ê–Ø-–ü–†–û–í–ï–†–ö–ê-–§–ê–ô–õ–û–í.txt** - –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –ø—Ä–æ–≤–µ—Ä–∫–µ
- **test-attachments.cjs** - —Å–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–∞–Ω–Ω—ã—Ö –≤ Directus

---

**–î–∞—Ç–∞:** 11.10.2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é  
**–í–µ—Ä—Å–∏—è:** 1.0.0
