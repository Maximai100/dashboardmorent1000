# Настройка прав доступа в Directus для ссылок

## Проблема

Поля `URL` и `Title` в коллекции `projects_files` (junction table) недоступны для чтения через API из-за настроек прав доступа.

**Ошибка:** 403 Forbidden при попытке прочитать эти поля.

## Решение

Нужно настроить права доступа в Directus Admin Panel.

## Инструкция

### 1. Откройте Directus Admin Panel

Перейдите по адресу: https://1.cycloscope.online/admin

### 2. Перейдите в Settings → Roles & Permissions

1. Нажмите на иконку настроек (⚙️) в левом нижнем углу
2. Выберите "Roles & Permissions"
3. Найдите роль, которая используется вашим токеном (обычно "Public" или custom role)

### 3. Настройте права для коллекции projects_files

1. Найдите коллекцию `projects_files` в списке
2. Нажмите на нее
3. Убедитесь, что включены права на чтение (Read)

### 4. Настройте права на поля

В разделе "Field Permissions" для операции Read:

1. Найдите поле `URL`
   - Убедитесь, что галочка стоит (поле доступно для чтения)
   
2. Найдите поле `Title`
   - Убедитесь, что галочка стоит (поле доступно для чтения)

### 5. Сохраните изменения

Нажмите кнопку "Save" в правом верхнем углу.

## Проверка

После настройки прав:

1. Перезагрузите приложение (F5)
2. Откройте консоль (F12)
3. Не должно быть ошибок 403 для запросов к `/items/projects_files`
4. Ссылки должны загружаться с названиями

## Альтернативное решение (временное)

Если нет доступа к Directus Admin Panel, можно использовать обходной путь:

### Вариант 1: Хранить данные локально

При добавлении ссылки сохранять `URL` и `Title` в localStorage:

```typescript
// При добавлении ссылки
const linkData = {
  id: attachment.id,
  URL: url,
  Title: title
};
localStorage.setItem(`link_${attachment.id}`, JSON.stringify(linkData));

// При загрузке
const linkData = localStorage.getItem(`link_${attachment.id}`);
if (linkData) {
  const { URL, Title } = JSON.parse(linkData);
  attachment.URL = URL;
  attachment.Title = Title;
}
```

### Вариант 2: Использовать другой токен

Создать новый токен с полными правами доступа:

1. В Directus Admin Panel → Settings → Access Tokens
2. Создать новый токен
3. Выбрать роль с полными правами (Admin)
4. Скопировать токен
5. Обновить `.env.local`:
   ```
   VITE_DIRECTUS_STATIC_TOKEN=новый_токен
   ```

## Рекомендация

Лучший вариант - настроить права доступа в Directus, так как это:
- Безопаснее (можно настроить точные права)
- Надежнее (данные хранятся в базе)
- Проще в поддержке (не нужны обходные пути)

## Структура прав

Минимальные права для работы со ссылками:

**Коллекция: projects_files**
- Read: ✅ Enabled
  - Поля:
    - id: ✅
    - projects_id: ✅
    - directus_files_id: ✅
    - URL: ✅ (ВАЖНО!)
    - Title: ✅ (ВАЖНО!)

- Create: ✅ Enabled
  - Все поля: ✅

- Update: ✅ Enabled
  - Все поля: ✅

- Delete: ✅ Enabled

## Контакты

Если нужна помощь с настройкой прав в Directus, обратитесь к администратору системы.
