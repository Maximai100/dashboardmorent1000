import{r as m,m as Y,n as B,o as q,p as z,q as H,j as e,P as G,s as Q,t as W,F as R,L as $,N as Z,e as K,f as V,v as ee,w as te,x as se,X as ae,T as J,S as X,y as le,C as re,d as ne}from"./index-DURz5Wpi.js";import{M as ie}from"./Modal-By9wbBfa.js";const ce=()=>{const[s,d]=m.useState([]),[b,N]=m.useState([]),[u,f]=m.useState(!0),[j,h]=m.useState(null),g=m.useCallback(async()=>{try{f(!0);const l=await Y();d(l);const n=localStorage.getItem("projectOrder");if(n){const i=new Set(l.map(S=>S.id)),o=JSON.parse(n).filter(S=>i.has(S));N(o)}else N(l.map(i=>i.id));h(null)}catch(l){h(l.message||"Failed to fetch projects")}finally{f(!1)}},[]);return m.useEffect(()=>{g()},[g]),m.useEffect(()=>{b.length>0&&localStorage.setItem("projectOrder",JSON.stringify(b))},[b]),{projects:s,projectOrder:b,setProjectOrder:N,loading:u,error:j,addProject:async l=>{try{const n=await H(l);return d(i=>[n,...i]),N(i=>[n.id,...i]),n}catch(n){h(n.message||"Failed to create project");return}},updateProject:async(l,n)=>{try{const i=await z(l,n);if(!i.attachments||i.attachments.some(o=>o.directus_files_id&&typeof o.directus_files_id=="string")){const o=await B(l);i.attachments=o}d(o=>o.map(S=>S.id===l?i:S))}catch(i){h(i.message||"Failed to update project")}},deleteProject:async l=>{try{await q(l),d(n=>n.filter(i=>i.id!==l)),N(n=>n.filter(i=>i!==l))}catch(n){h(n.message||"Failed to delete project")}},loadProjectAttachments:async l=>{try{const n=await B(l);return d(i=>i.map(o=>o.id===l?{...o,attachments:n}:o)),n}catch(n){return console.warn(`Failed to load attachments for project ${l}:`,n),[]}}}},oe=({onNewProject:s})=>e.jsxs("header",{className:"mb-6 flex justify-between items-center flex-wrap gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-white",children:"Дашборд руководителя"}),e.jsx("p",{className:"text-sm sm:text-base text-slate-400",children:"Управляйте текущими проектами, задачами и ресурсами."})]}),e.jsx("div",{children:e.jsxs("button",{onClick:s,className:"inline-flex items-center justify-center gap-2 px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-lg shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 focus:ring-offset-slate-800",children:[e.jsx(G,{className:"w-5 h-5"}),e.jsx("span",{children:"Новый проект"})]})})]});var P=(s=>(s.InProgress="в работе",s.Completed="завершено",s.Archived="архив",s))(P||{});const de=({searchText:s,onSearchTextChange:d,statusFilter:b,onStatusFilterChange:N,attachmentFilter:u,onAttachmentFilterChange:f})=>{const j=[{label:"Все",value:"all",icon:e.jsx(W,{className:"w-4 h-4 mr-1.5"})},{label:"Файл",value:"file",icon:e.jsx(R,{className:"w-4 h-4 mr-1.5"})},{label:"Ссылка",value:"link",icon:e.jsx($,{className:"w-4 h-4 mr-1.5"})},{label:"Нет",value:"none",icon:e.jsx(Z,{className:"w-4 h-4 mr-1.5"})}];return e.jsxs("div",{className:"mb-6 p-4 bg-slate-800 rounded-lg flex flex-col sm:flex-row items-center gap-4 flex-wrap",children:[e.jsxs("div",{className:"relative w-full sm:flex-1 sm:min-w-[250px]",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Q,{className:"h-5 w-5 text-slate-400"})}),e.jsx("input",{type:"text",placeholder:"Поиск по проекту или ответственному...",value:s,onChange:h=>d(h.target.value),className:"bg-slate-700 border border-slate-600 text-white text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full pl-10 p-2.5"})]}),e.jsx("div",{className:"w-full sm:w-auto",children:e.jsxs("select",{value:b,onChange:h=>N(h.target.value),className:"bg-slate-700 border border-slate-600 text-white text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5",children:[e.jsx("option",{value:"all",children:"Все статусы"}),e.jsx("option",{value:P.InProgress,children:P.InProgress}),e.jsx("option",{value:P.Completed,children:P.Completed}),e.jsx("option",{value:P.Archived,children:P.Archived})]})}),e.jsx("div",{className:"w-full sm:w-auto flex items-center bg-slate-700 rounded-lg p-1 space-x-1",children:j.map(({label:h,value:g,icon:x})=>e.jsxs("button",{onClick:()=>f(g),className:`flex items-center justify-center w-full sm:w-auto px-3 py-1.5 text-sm font-medium rounded-md transition-colors ${u===g?"bg-blue-600 text-white shadow":"text-slate-300 hover:bg-slate-600 hover:text-white"}`,children:[x,h]},g))})]})},me=({status:s})=>{const d=()=>{switch(s){case P.InProgress:return"bg-sky-500/20 text-sky-400";case P.Completed:return"bg-green-500/20 text-green-400";case P.Archived:return"bg-slate-500/20 text-slate-400";default:return"bg-slate-700 text-slate-300"}};return e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${d()}`,children:s})},ue=({project:s,onRowClick:d,isDragged:b,onDragStart:N,onDrop:u})=>{const[f,j]=m.useState(!1),h=new Date(s.deadline)<new Date&&s.status!=="завершено"&&s.status!=="архив",g=l=>{const n=new Date(l),i=String(n.getDate()).padStart(2,"0"),o=String(n.getMonth()+1).padStart(2,"0"),S=n.getFullYear();return`${i}.${o}.${S}`},x=l=>{l.preventDefault(),j(!0)},p=l=>{l.preventDefault(),j(!1)},k=l=>{l.preventDefault(),j(!1),u(s.id)},C=["transition-colors",b?"opacity-30":"hover:bg-slate-700/50",f?"border-t-2 border-blue-500":""].join(" ");return e.jsxs("tr",{draggable:"true",onDragStart:()=>N(s.id),onDragOver:x,onDragLeave:p,onDrop:k,className:C,children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap cursor-pointer",onClick:()=>d(s),children:e.jsx("div",{className:"text-sm font-medium text-white",children:s.name})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-300 cursor-pointer",onClick:()=>d(s),children:s.responsible}),e.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-sm cursor-pointer ${h?"text-red-400 font-bold":"text-slate-300"}`,onClick:()=>d(s),children:g(s.deadline)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap cursor-pointer",onClick:()=>d(s),children:e.jsx(me,{status:s.status})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap cursor-pointer",onClick:()=>d(s),children:e.jsx("div",{className:"flex flex-wrap items-center gap-1.5",children:s.tags&&s.tags.length>0?s.tags.map(l=>e.jsx("span",{className:"px-2 py-0.5 text-xs rounded bg-slate-700 text-slate-300",children:l},l)):e.jsx("span",{className:"text-slate-500 text-xs",children:"—"})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-300 cursor-pointer",onClick:()=>d(s),children:!s.attachments||s.attachments.length===0?e.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded bg-red-500/20 text-red-400",children:"Нет вложений"}):e.jsx("div",{className:"flex items-center space-x-2",children:(s.attachments||[]).map(l=>{if(l.url)return e.jsx("a",{href:l.url,target:"_blank",rel:"noopener noreferrer",title:l.title||l.url,onClick:n=>n.stopPropagation(),children:e.jsx($,{className:"w-5 h-5 text-slate-400 hover:text-blue-400"})},l.id);if(l.directus_files_id){const n=`${K}/assets/${l.directus_files_id.id}?access_token=${V}`;return e.jsx("a",{href:n,target:"_blank",rel:"noopener noreferrer",title:l.directus_files_id.title,onClick:i=>i.stopPropagation(),children:e.jsx(R,{className:"w-5 h-5 text-slate-400 hover:text-blue-400"})},l.id)}return null})})}),e.jsx("td",{className:"px-6 py-4 text-sm text-slate-400 max-w-sm truncate cursor-pointer",onClick:()=>d(s),children:s.notes||"—"})]})},xe=({projects:s,onRowClick:d,sortConfig:b,onSort:N,draggedProjectId:u,onDragStart:f,onDrop:j})=>{const h=[{key:"name",label:"ДЕЛО / ПРОЕКТ",isSortable:!0},{key:"responsible",label:"ОТВЕТСТВЕННЫЙ",isSortable:!0},{key:"deadline",label:"ДЕДЛАЙН",isSortable:!0},{key:"status",label:"СТАТУС",isSortable:!0},{key:"tags",label:"ТЕГИ",isSortable:!1},{key:"attachments",label:"ТАБЛИЦА",isSortable:!1},{key:"notes",label:"ПРИМЕЧАНИЯ",isSortable:!1}],g=({columnKey:x})=>b.key!==x?null:b.direction==="asc"?e.jsx(te,{className:"w-3 h-3 ml-1.5 inline-block"}):e.jsx(se,{className:"w-3 h-3 ml-1.5 inline-block"});return s.length===0?e.jsxs("div",{className:"text-center py-16 bg-slate-800 rounded-lg shadow-md",children:[e.jsx(ee,{className:"mx-auto h-12 w-12 text-slate-500"}),e.jsx("h3",{className:"mt-2 text-lg font-medium text-white",children:"Проекты не найдены"}),e.jsx("p",{className:"mt-1 text-sm text-slate-400",children:"Попробуйте изменить фильтры или добавить новый проект."})]}):e.jsx("div",{className:"bg-slate-800 shadow-md rounded-lg overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-700",children:[e.jsx("thead",{className:"bg-slate-700/50",children:e.jsx("tr",{children:h.map(({key:x,label:p,isSortable:k})=>e.jsx("th",{scope:"col",className:`px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider whitespace-nowrap ${k?"cursor-pointer hover:text-slate-200":""}`,onClick:()=>k&&N(x),children:e.jsxs("div",{className:"flex items-center",children:[p,k&&e.jsx(g,{columnKey:x})]})},x))})}),e.jsx("tbody",{className:"bg-slate-800 divide-y divide-slate-700",children:s.map(x=>e.jsx(ue,{project:x,onRowClick:d,isDragged:u===x.id,onDragStart:f,onDrop:j},x.id))})]})})})},he=({project:s,onClose:d,onSave:b,onDelete:N})=>{const[u,f]=m.useState(s),[j,h]=m.useState(""),[g,x]=m.useState(!1),[p,k]=m.useState({url:"",title:""}),[C,l]=m.useState(!1),n=m.useRef(null);m.useEffect(()=>{f(s)},[s]);const i=t=>{const{name:a,value:r}=t.target;f(w=>({...w,[a]:r}))},o=t=>{const a=t.target.value;if(a){const r=new Date(u.deadline);r.setFullYear(parseInt(a.substring(0,4),10)),r.setMonth(parseInt(a.substring(5,7),10)-1),r.setDate(parseInt(a.substring(8,10),10)),f(w=>({...w,deadline:r.toISOString()}))}},S=t=>{t.key==="Enter"&&j.trim()!==""&&(t.preventDefault(),u.tags.includes(j.trim())||f(a=>({...a,tags:[...a.tags,j.trim()]})),h(""))},_=t=>{f(a=>({...a,tags:a.tags.filter(r=>r!==t)}))},O=t=>{f(a=>({...a,attachments:(a.attachments||[]).filter(r=>r.id!==t)}))},A=async t=>{var r;const a=(r=t.target.files)==null?void 0:r[0];if(a)try{l(!0);const w=await ne(a),v={id:Date.now()*-1,projects_id:s.id,directus_files_id:w};f(c=>({...c,attachments:[...c.attachments||[],v]}))}catch(w){console.error("File upload failed:",w),alert("Не удалось загрузить файл.")}finally{l(!1)}t.target&&(t.target.value="")},L=()=>{if(!p.url.trim())return;const t={id:Date.now()*-1,projects_id:s.id,url:p.url.trim(),title:p.title.trim()||p.url.trim()};f(a=>({...a,attachments:[...a.attachments||[],t]})),k({url:"",title:""}),x(!1)},E=()=>{const t=(u.attachments||[]).filter(r=>r.directus_files_id||r.url&&r.url.trim()!==""),a={...u,attachments:t.map(r=>({id:r.id>0?r.id:void 0,url:r.url||null,title:r.title||null,directus_files_id:r.directus_files_id?r.directus_files_id.id:null}))};b(a)},U=()=>{window.confirm(`Вы уверены, что хотите удалить проект "${s.name}"?`)&&N(s.id)},I="bg-slate-700 border border-slate-600 text-white text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5",M=e.jsxs("div",{className:"flex justify-between w-full",children:[e.jsxs("button",{type:"button",onClick:U,className:"inline-flex items-center gap-2 text-red-400 hover:text-red-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center transition-colors",children:[e.jsx(J,{className:"w-4 h-4"}),"Удалить проект"]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{type:"button",onClick:d,className:"text-white bg-slate-600 hover:bg-slate-700 border border-slate-500 focus:outline-none focus:ring-4 focus:ring-slate-500 font-medium rounded-lg text-sm px-5 py-2.5",children:"Отмена"}),e.jsx("button",{type:"button",onClick:E,className:"text-white bg-blue-600 hover:bg-blue-700 focus:ring-4 focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5",children:"Сохранить изменения"})]})]}),T=(u.attachments||[]).filter(t=>t.directus_files_id||t.url);return e.jsx(ie,{title:"Детали проекта",onClose:d,footer:M,children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block mb-2 text-sm font-medium text-white",children:"Название проекта"}),e.jsx("input",{type:"text",id:"name",name:"name",value:u.name,onChange:i,className:I})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"responsible",className:"block mb-2 text-sm font-medium text-white",children:"Ответственный"}),e.jsx("input",{type:"text",id:"responsible",name:"responsible",value:u.responsible,onChange:i,className:I})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"deadline",className:"block mb-2 text-sm font-medium text-white",children:"Дедлайн"}),e.jsx("input",{type:"date",id:"deadline",name:"deadline",value:u.deadline.split("T")[0],onChange:o,className:I})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"status",className:"block mb-2 text-sm font-medium text-white",children:"Статус"}),e.jsx("select",{id:"status",name:"status",value:u.status,onChange:i,className:I,children:Object.values(P).map(t=>e.jsx("option",{value:t,children:t},t))})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"tags",className:"block mb-2 text-sm font-medium text-white",children:"Теги"}),e.jsxs("div",{className:"flex flex-wrap gap-2 items-center p-2 border border-slate-600 rounded-lg bg-slate-700",children:[u.tags.map(t=>e.jsxs("span",{className:"flex items-center bg-blue-900 text-blue-300 text-xs font-medium px-2 py-1 rounded-full",children:[t,e.jsx("button",{onClick:()=>_(t),className:"ml-1.5 -mr-0.5 p-0.5 rounded-full hover:bg-blue-700",children:e.jsx(ae,{className:"w-3 h-3"})})]},t)),e.jsx("input",{type:"text",value:j,onChange:t=>h(t.target.value),onKeyDown:S,placeholder:"Добавить тег...",className:"bg-transparent focus:outline-none flex-grow text-sm min-w-[100px] text-white"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"notes",className:"block mb-2 text-sm font-medium text-white",children:"Заметки"}),e.jsx("textarea",{id:"notes",name:"notes",rows:4,value:u.notes,onChange:i,className:I})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-semibold text-slate-200 mb-2",children:"Вложения"}),T.length>0&&e.jsx("ul",{className:"border border-slate-700 rounded-lg divide-y divide-slate-700 mb-4",children:T.map(t=>{const a=!!t.url,r=!!t.directus_files_id,w=r?`${K}/assets/${t.directus_files_id.id}?access_token=${V}`:"#",v=t.url||w,c=t.title||(r?t.directus_files_id.title:"")||"Без названия",y=r?`${t.directus_files_id.type}, ${(t.directus_files_id.filesize/1024).toFixed(2)} KB`:t.url;return e.jsxs("li",{className:"p-3 flex items-center justify-between hover:bg-slate-700/50",children:[e.jsxs("a",{href:v,target:"_blank",rel:"noopener noreferrer",className:"flex items-center min-w-0 flex-grow group",title:c,children:[a?e.jsx($,{className:"w-5 h-5 mr-3 text-slate-400 flex-shrink-0"}):e.jsx(R,{className:"w-5 h-5 mr-3 text-slate-400 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-white truncate group-hover:text-blue-400 transition-colors",children:c}),e.jsx("p",{className:"text-xs text-slate-400 truncate",children:y})]})]}),e.jsx("button",{onClick:()=>O(t.id),className:"ml-4 p-1.5 rounded-full hover:bg-red-900/50 text-slate-400 hover:text-red-400 flex-shrink-0",title:"Удалить вложение",children:e.jsx(J,{className:"w-4 h-4"})})]},t.id)})}),e.jsxs("div",{className:"space-y-3 p-3 bg-slate-700/50 rounded-lg",children:[e.jsx("button",{type:"button",onClick:()=>{var t;return(t=n.current)==null?void 0:t.click()},disabled:C,className:"w-full flex items-center justify-center gap-2 px-4 py-2 text-sm font-medium text-white bg-slate-600 border border-slate-500 rounded-lg shadow-sm hover:bg-slate-500 disabled:bg-slate-500 disabled:cursor-wait",children:C?e.jsxs(e.Fragment,{children:[e.jsx(X,{className:"w-5 h-5 animate-spin"}),e.jsx("span",{children:"Загрузка..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(le,{className:"w-5 h-5"}),e.jsx("span",{children:"Загрузить файл"})]})}),e.jsx("input",{type:"file",ref:n,onChange:A,className:"hidden"}),e.jsxs("button",{type:"button",onClick:()=>x(!g),className:"w-full flex items-center justify-center gap-2 px-4 py-2 text-sm font-medium text-white bg-slate-600 border border-slate-500 rounded-lg shadow-sm hover:bg-slate-500",children:[e.jsx($,{className:"w-5 h-5"}),e.jsx("span",{children:g?"Отменить":"Добавить ссылку"})]}),g&&e.jsxs("div",{className:"pt-3 border-t border-slate-600 space-y-3",children:[e.jsx("input",{type:"url",placeholder:"https://example.com/document",value:p.url,onChange:t=>k(a=>({...a,url:t.target.value})),className:I}),e.jsx("input",{type:"text",placeholder:"Название (необязательно)",value:p.title,onChange:t=>k(a=>({...a,title:t.target.value})),className:I}),e.jsx("button",{type:"button",onClick:L,disabled:!p.url.trim(),className:"w-full text-white bg-blue-600 hover:bg-blue-700 focus:ring-4 focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 disabled:bg-blue-500 disabled:cursor-not-allowed",children:"Сохранить ссылку"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-semibold text-slate-200 mb-2",children:"История изменений"}),e.jsx("ul",{className:"space-y-2 text-sm",children:u.history.map(t=>e.jsxs("li",{className:"flex items-center text-slate-400",children:[e.jsx(re,{className:"w-4 h-4 mr-2 flex-shrink-0"}),new Date(t.timestamp).toLocaleString("ru-RU")," - ",e.jsx("span",{className:"font-medium text-slate-300 mx-1",children:t.user})," - ",t.action]},t.id))})]})]})})},ge=()=>{const{projects:s,projectOrder:d,setProjectOrder:b,loading:N,error:u,addProject:f,updateProject:j,deleteProject:h}=ce(),[g,x]=m.useState(null),[p,k]=m.useState(()=>localStorage.getItem("projectSearchText")||""),[C,l]=m.useState(()=>localStorage.getItem("projectStatusFilter")||"all"),[n,i]=m.useState(()=>localStorage.getItem("projectAttachmentFilter")||"all"),[o,S]=m.useState(()=>{const a=localStorage.getItem("projectSortConfig");return a?JSON.parse(a):{key:"deadline",direction:"asc"}}),[_,O]=m.useState(null);m.useEffect(()=>{localStorage.setItem("projectSearchText",p),localStorage.setItem("projectStatusFilter",C),localStorage.setItem("projectAttachmentFilter",n),localStorage.setItem("projectSortConfig",JSON.stringify(o))},[p,C,n,o]);const A=m.useMemo(()=>{const a=new Map(s.map(c=>[c.id,c]));let r=d.map(c=>a.get(c)).filter(c=>c!==void 0);const w=new Set(r.map(c=>c.id));s.forEach(c=>{w.has(c.id)||r.push(c)});let v=[...r];if(p){const c=p.toLowerCase();v=v.filter(y=>y.name.toLowerCase().includes(c)||y.responsible.toLowerCase().includes(c)||y.tags&&y.tags.length>0&&y.tags.some(D=>D.toLowerCase().includes(c)))}return C!=="all"&&(v=v.filter(c=>c.status===C)),n!=="all"&&(v=v.filter(c=>{const y=c.attachments||[],D=y.length>0;switch(n){case"file":return y.some(F=>F.directus_files_id);case"link":return y.some(F=>F.url);case"none":return!D;default:return!0}})),o.key&&v.sort((c,y)=>{const D=c[o.key],F=y[o.key];return D<F?o.direction==="asc"?-1:1:D>F?o.direction==="asc"?1:-1:0}),v},[s,p,C,n,o,d]),L=a=>{let r="asc";o.key===a&&o.direction==="asc"&&(r="desc"),S({key:a,direction:r})},E=async()=>{const a={name:"Новый проект",responsible:"Не назначен",deadline:new Date().toISOString(),attachments:[],notes:""},r=await f(a);r&&x(r)},U=async a=>{const{id:r,...w}=a;await j(r,w),x(null)},I=async a=>{await h(a),x(null)},M=m.useCallback(a=>{O(a)},[]),T=m.useCallback(a=>{if(!_)return;const r=A.map(D=>D.id),w=r.indexOf(_),v=r.indexOf(a);if(w===-1||v===-1)return;const c=[...r],[y]=c.splice(w,1);c.splice(v,0,y),S({key:null,direction:"asc"}),b(c),O(null)},[_,A,b]),t=()=>N?e.jsxs("div",{className:"flex justify-center items-center h-64",children:[e.jsx(X,{className:"w-8 h-8 animate-spin text-blue-500"}),e.jsx("p",{className:"ml-4 text-slate-400",children:"Загрузка проектов..."})]}):u?e.jsxs("div",{className:"text-center py-16 bg-red-900/20 border border-red-500/30 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-medium text-red-400",children:"Ошибка при загрузке проектов"}),e.jsx("p",{className:"mt-1 text-sm text-slate-400",children:u}),e.jsx("p",{className:"mt-2 text-xs text-slate-500",children:"Убедитесь, что Directus запущен и конфигурация в `config.ts` верна."})]}):e.jsx(xe,{projects:A,onRowClick:x,sortConfig:o,onSort:L,draggedProjectId:_,onDragStart:M,onDrop:T});return e.jsxs("div",{children:[e.jsx(oe,{onNewProject:E}),e.jsxs("main",{children:[e.jsx(de,{searchText:p,onSearchTextChange:k,statusFilter:C,onStatusFilterChange:l,attachmentFilter:n,onAttachmentFilterChange:i}),t()]}),g&&e.jsx(he,{project:g,onClose:()=>x(null),onSave:U,onDelete:I})]})};export{ge as default};
